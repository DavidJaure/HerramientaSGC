<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Auditoría ISO 9001:2015</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 font-sans">

<div class="max-w-6xl mx-auto py-10 px-6">
  <h1 class="text-4xl font-bold text-blue-700 text-center mb-8">✅ Auditoría ISO 9001:2015 (Capítulos 4 al 10)</h1>

  <form action="/iso9001/auditoria" method="POST" class="space-y-8 bg-white shadow-lg rounded-2xl p-8">

    <!-- Capítulos 4 al 10 (Checklist completo) -->
    {% for cap, items in [
      ("4: Contexto de la organización", [
        ("4.1", "¿La organización ha identificado factores internos y externos que afectan al SGC?"),
        ("4.2", "¿Se han identificado las partes interesadas y sus necesidades?"),
        ("4.3", "¿Se definió el alcance del SGC, considerando productos, servicios y exclusiones?"),
        ("4.4", "¿Existe un mapa de procesos con entradas, salidas, secuencia e interacciones?")
      ]),
      ("5: Liderazgo", [
        ("5.1", "¿La alta dirección demuestra liderazgo y compromiso con el SGC?"),
        ("5.2", "¿Está definida y comunicada la política de calidad?"),
        ("5.3", "¿Se han asignado roles, responsabilidades y autoridades dentro del SGC?")
      ]),
      ("6: Planificación", [
        ("6.1", "¿Se han identificado riesgos y oportunidades? ¿Existe una matriz de riesgos?"),
        ("6.2", "¿Están definidos objetivos de calidad, medibles y con seguimiento?"),
        ("6.3", "¿Se planifican cambios al SGC de manera controlada?")
      ]),
      ("7: Soporte", [
        ("7.1", "¿Se cuenta con recursos adecuados (infraestructura, ambiente, tecnología)?"),
        ("7.2", "¿El personal es competente y hay registros de capacitación?"),
        ("7.3", "¿Se asegura la toma de conciencia sobre política y objetivos de calidad?"),
        ("7.4", "¿Se mantiene comunicación interna y externa efectiva?"),
        ("7.5", "¿La información documentada (procedimientos, registros) está controlada?")
      ]),
      ("8: Operación", [
        ("8.1", "¿Se planifican y controlan las operaciones bajo condiciones controladas?"),
        ("8.2", "¿Se gestionan adecuadamente los requisitos del cliente (contratos, pedidos)?"),
        ("8.3", "¿Hay control en el diseño y desarrollo (cuando aplica)?"),
        ("8.4", "¿Los proveedores externos son evaluados y controlados?"),
        ("8.5", "¿La producción/servicio cumple requisitos definidos (instrucciones, equipos)?"),
        ("8.6", "¿Se realizan controles de liberación de productos/servicios?"),
        ("8.7", "¿Los productos/servicios no conformes se controlan y registran?")
      ]),
      ("9: Evaluación del desempeño", [
        ("9.1", "¿Se hace seguimiento, medición y análisis de indicadores de calidad?"),
        ("9.2", "¿Se realizan auditorías internas planificadas y con registros?"),
        ("9.3", "¿La alta dirección realiza la revisión por la dirección con entradas/salidas claras?")
      ]),
      ("10: Mejora", [
        ("10.1", "¿Se gestionan oportunidades de mejora continuamente?"),
        ("10.2", "¿Se aplican acciones correctivas para tratar no conformidades?"),
        ("10.3", "¿Se mejora continuamente la eficacia del SGC?")
      ])
    ] %}
    <section class="border-l-4 border-blue-600 pl-4 py-3 bg-gray-50 rounded-md shadow-sm">
      <h2 class="text-lg font-semibold text-blue-700 mb-2">📌 Capítulo {{ cap }}</h2>
      <div class="space-y-2">
        {% for id, texto in items %}
        <label class="flex items-center bg-white rounded-md p-2 shadow-sm hover:bg-blue-50 transition">
          <input type="checkbox" name="{{ id }}" class="w-5 h-5 text-blue-600">
          <span class="ml-2">{{ id }} {{ texto }}</span>
        </label>
        {% endfor %}
      </div>
    </section>
    {% endfor %}

    <!-- Observaciones -->
    <section>
      <h2 class="text-xl font-semibold mt-6 mb-2 text-blue-700">📝 Observaciones</h2>
      <textarea name="observaciones" rows="5" class="w-full border border-gray-300 rounded-lg p-3 focus:ring-2 focus:ring-blue-300" placeholder="Escribe tus observaciones aquí..."></textarea>
    </section>

    <!-- Plantillas completadas -->
    <h1 class="text-2xl font-bold text-center mt-8 mb-4 text-blue-700">📂 Plantillas de Implementación</h1>
    <ul class="space-y-3 max-w-xl mx-auto">
      {% for plantilla in plantillas %}
        <li class="flex justify-between items-center p-4 rounded-lg shadow-md {{ 'bg-green-100 text-green-800' if plantilla.completada else 'bg-red-100 text-red-800' }}">
          <span>{{ plantilla.nombre }}</span>
          {% if plantilla.completada %}
            <a href="/descargar/{{ plantilla.nombre }}" class="ml-4 px-3 py-1 bg-green-600 text-white rounded hover:bg-green-700 transition">📥 Descargar</a>
          {% endif %}
        </li>
      {% endfor %}
    </ul>

    <!-- Botones -->
    <div class="flex justify-center gap-4 pt-6">
      <button type="submit" class="bg-blue-600 hover:bg-blue-700 text-white px-6 py-2 rounded-lg shadow-md transition">💾 Guardar Checklist</button>
      <a href="/generar_pdf" class="bg-green-600 hover:bg-green-700 text-white px-6 py-2 rounded-lg shadow-md transition">📄 Generar Informe PDF</a>
    </div>

  </form>
</div>

</body>
</html>
